"use strict";function Game(e){function t(){d.innerText=p.score}function n(){var e=p.flippedCards[0],n=p.flippedCards[1];e.value==n.value?(r++,p.score+=100,e.hideCard(),n.hideCard(),t(),r==s&&(window.clearInterval(a),u.innerText="You won!",g.innerText="Play again",m.classList.remove("hidden"),p.score>max.score&&(message.innerHTML="<p>New best score! <span>"+p.score+"</span></p>",max.score=p.score,save.setData("score",max)))):((e.seen||n.seen)&&(p.score-=50,t()),e.seen=!0,e.toggleCard(),n.seen=!0,n.toggleCard()),p.flippedCards=[]}var a,s=10,r=0,i=[],o=e.container,d=e.scoreDisplay,c=e.minuteDisplay,l=e.secondDisplay,m=e.messageBox,u=e.messageDisplay,g=e.messageBtn,p={score:0,initTime:(new Date).getTime(),flippedCards:[]};return{init:function(){m.classList.add("hidden");for(var e=[],t=0;t<2*s;t++){var r;(r=t<10?new Card(t,t):new Card(t-10,t)).element.addEventListener("click",function(){!function(e){if(p.flippedCards.length<2){var t=i.filter(function(t){return Number(t.id)==Number(e.id)})[0];p.flippedCards.push(t),t.toggleCard(),2==p.flippedCards.length&&setTimeout(n,1e3)}}(this)}),e.push(r)}for(t=0;t<2*s;t++){var d=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e}(0,2*s-t);i.push(e[d]),o.appendChild(e[d].element),e.splice(d,1)}a=window.setInterval(function(){var e=((new Date).getTime()-p.initTime)/1e3,t=Math.floor(e/60),n=Math.floor(e-60*t);l.innerText=n<10?"0"+n:n,c.innerText=t<10?"0"+t:t},1e3)}}}function Card(e,t){var n=this;n.value=e,n.id=t,n.compose=function(){var e=document.createElement("div");e.classList.add("card-wrapper"),e.setAttribute("id",n.id);var t=document.createElement("div");t.classList.add("card-3D");var a=document.createElement("span");a.setAttribute("class","card front card"+n.value);var s=document.createElement("span");return s.setAttribute("class","card back"),t.appendChild(s),t.appendChild(a),e.appendChild(t),e},n.toggleCard=function(){n.element.getElementsByClassName("card-3D")[0].classList.toggle("flipped")},n.hideCard=function(){n.element.classList.add("hidden")},n.element=n.compose(),n.seen=!1}function newGame(){config.container.innerHTML="",config.scoreDisplay.innerText=0;new Game(config).init()}function init(){if("serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("sw.js").then(function(e){console.log("ServiceWorker registration successful with scope: ",e.scope)},function(e){console.log("ServiceWorker registration failed: ",e)})}),save.getData("score")){max={score:save.getData("score").score};document.getElementById("message").innerHTML="<p>Best score: <span>"+max.score+"</span></p>"}else max={score:0}}!function(e){e.save={setData:function(e,t){if(!e||!t)return console.log("Error. Required fields"),!1;localStorage.setItem(e,JSON.stringify(t))},getData:function(e){if(!e)return console.log("Error. Required fields"),!1;var t=localStorage.getItem(e);return t?t=JSON.parse(t):(console.log("No data stored"),!1)}}}(window);var config={container:document.getElementById("game-wrapper"),scoreDisplay:document.getElementById("score-display"),minuteDisplay:document.getElementById("minute-display"),secondDisplay:document.getElementById("second-display"),messageBox:document.getElementById("message-box"),messageDisplay:document.getElementById("message-display"),messageBtn:document.getElementById("message-btn")},resetBtn=document.getElementById("reset-btn");resetBtn.addEventListener("click",newGame);var startBtn=document.getElementById("message-btn");startBtn.addEventListener("click",newGame);var max;init();